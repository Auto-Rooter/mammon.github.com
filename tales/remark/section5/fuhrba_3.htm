<HTML>
<HEAD>
<!--  formamus.htm version 02 February 1998 
      INSTRUCTIONS FOR SUBMITTING: DO NOT USE HTML EDITORS!
      SEARCH THIS TEXT FOR THE STRING "Your_" 
      AND REPLACE WITH WHATEVER YOU WANT TO PUBLISH! 
      THANKS A LOT: this will allow automated retrieval -->
<TITLE>fuhrba_3.htm Marx Crypto Box, the most
Secure device ever made</TITLE>
</HEAD>

<BODY BGCOLOR=#CCCCCC TEXT=#001010 VLINK=#405040>
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="22"  WIDTH= "100%">
<TR><td></td>
<td>
<!-- Choose  a TITLE probably wont be changed -->
<center><FONT SIZE="+2">Marx Crypto Box, the most
Secure device ever made</fonT><br>
        <FONT SIZE="+1">("Protection Plus Professional")</fonT>
</center>
</td>

<td>
<!-- Choose  a PROJECT GIF, leave this if unsure -->
<center><a href="project3.htm" tppabs="http://ftp.fravia.org/project3.htm"><IMG SRC="project3.gif" tppabs="http://ftp.fravia.org/project3.gif" ALT="project3" 
ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 
HSPACE=0></a>
<br>
<font color=gray>Dongles</FonT>
</center></td></tr>
<tR>
<td bgcolor="#FFFFEA"><center>
<FONT COLOR="890000">
<!-- CHOOSE A DATE (will probably be changed) -->
03 February 1998
</FONT></center>
</td>
<td bgcolor="#FFFFEA"><center>by <font size=+3>
<!-- CHOOSE A HANDLE (wont be changed) -->
Dr. Fuhrball
</fonT></center>
</td>
<td VALIGN="center" bgcolor="#FFFFEA"><FONT COLOR="890000"><center>
<a href="#anchoruppa">Updated</a><bR>
05 February 1998</center>
</td>
</tr>
<TR><td><center><a href="index.html" tppabs="http://ftp.fravia.org/index.html"><IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALIGN="BOTTOM" 
BORDER="0" VSPACE="0" HSPACE="0"></a></center></td>
<TD BGCOLOR="898030"><center>Courtesy of Fravia's page of 
reverse engineering</center> 
</center></TD>
<td BGCOLOR="898030">
<center>
<!-- Your truly+ will edit only if really necessary -->
<pre> </prE></center></td>
</TR>
<tr><td></td><td><i><center>
<!-- Your truly+ will probably comment -->
Interesting reading... Dr Fuhrball has already given us the
<A HREF="fuhrba.htm" tppabs="http://ftp.fravia.org/fuhrba.htm">Simple unix busting</a> essay... note that the  
 cracking approach chosen here is perfectly accettable: the Author shows how the 
protection scheme works inside a target (so that all readers can learn) 
WITHOUT giving out 
a ready made crack for a valuable program to all lamers of the planet. Well, 
with 'our' dongle protection schemes we are getting quite forward, just a 
request to Dr Furhball for an add on as soon as he has some 
time:</i>
</center><prE>...when I soldered enough wires to the microprocessor 
and stuck it in the pic burner I was able to read out the 
entire contents of the processor chip</prE><i><center>
many among our readers do NOT know how to read eeprom data. Could 
you please (since you are I believe the first one speaking of 
this subject in an essay published at the HCU) explain with 
some "length and depth" the whole process? (trial and errors comprised :-)<br>
<a name="anchoruppa"></a></i><hr size=1><FONT COLOR="890000"><font size=+2>
5 February 1998</fonT></fonT><bR><i>
Dr Fuhrball has answered with a first essay of a future 'hardware cracking' section, 
that for the moment will be hosted inside the dongle section. Thank a lot Dr Fuhrball! 
Hope you (and others :-) will send more and more essays on this gorgeous stuff, 
since few crackers 
(at the moment :-) practicize these interesting skills!<br>Here it is: 
Dr Fuhrball's <IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13
BORDER=0 VSPACE=0 HSPACE=0><a href="drfuh5.htm" tppabs="http://ftp.fravia.org/drfuh5.htm">treatment on the hardware side of
accessing eeproms</a><bR> (with three hand-written dongle wiring schemas and a short 
basic program)
<br>Enjoy!<br>

</i></center></td>
<td></td>
</tr>
<TR><td></td>
<!-- Leonard Coehn's old song -->
<TD BGCOLOR="898030"><center></i><b>There is a crack, a crack in everything 
That's how the light gets in</b></center>
</center></TD><td></td>
</TR>
<TR>
<td VALIGN= "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
Rating</FONT></FONT></center>
</TD>
<td VALIGN = "MIDDLE" bgcolor="#C6E7C6"><font color=blue><center>
<!-- CHOOSE A RATING (may be changed) -->
( )<B>Beginner</B> (X)<B>Intermediate</B> ( )<B>Advanced</B> ( )<B>Expert</B></FONT>
</center></td>
<td></td>
</tr>
</table>
<!-- END HEAD  -->
<bR>
<!-- CORPUS  -->

<!-- CHOOSE A COMMENT (may be changed)  -->
An useful essay about the reversing of a dongle based protection scheme
<hR>
<center>
   <FONT SIZE="+2">
<!-- CHOOSE A TITLE (wont probably be changed) -->
Marx Crypto Box, the most
Secure device ever made
   </FONT><BR>
   <FONT SIZE="+2">
<!-- CHOOSE A SUBTITLE (wont proabbly be changed) -->
("Protection Plus Professional")
   </FONT><BR>
   <FONT COLOR="0B7FC1">
<!-- REPEAT YOUR CHOSEN HANDLE HERE -->Written by 
Dr Fuhrball
   </FONT>
</center><br><br>

<!-- INTRO STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Introduction</fonT>
</fonT></center></td></tr></table>
<pre>I've decided to leave the universal dll shim for a later 
effort as i am gonna be seriously busy the next 3 weeks.

Today's cocktail:  40 year old single speyside malt "The Glenrothes"
(got a bottle of this for christmas. Wish I had a case)</prE>

<!-- TOOLS STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Tools required</fonT>
</fonT></center></td></tr></table>
Wdasm<br>
eprom burner <!-- PASTE HERE YOUR REQUIRED TOOLS -->
<br><br>

<!-- TARGET URL STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Target's URL/FTP</fonT>
</fonT></center></td></tr></table>
<!-- DON'T FORGET TO PASTE HERE THE URL/FTP OF YOUR TARGET(S) -->
<a href="tppmsgs/msgs4.htm#437" tppabs="http://www.marx.com/">http://www.marx.com</a>
<br><br>

<!-- REAL ESSAY  STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Essay</fonT></fonT>
</center></td></tr></table>
<pre><center>Marx Crypto Box, highly simplified, 
by Dr. Fuhrball</center>

The most recent and highly excellent essay from <A HREF="fp_dong1.htm" tppabs="http://ftp.fravia.org/fp_dong1.htm">Frogs Print</A> covers much of
what I could possibly say about this subject. Here is an example of the Marx
crypto box dongle. A totally bogus and highly insecure device in many ways.

Their advertising on this device (www.marx.com) says that this is the most
Secure device ever made, with a custom risc processor. The fact is that
The device uses a pic16 processor (low voltage with 2mhz oscillator) and
an 8kbit eeprom, both devices made by Microchip Inc. But it's even better,
because when I soldered enough wires to the microprocessor and stuck it in
the pic burner, I was able to read out the entire contents of the processor
chip. This is secure????? And the same thing goes for the data inside the
eeprom.

Marx also sells a software only protection system
(Protection Plus Professional). A free evaluation copy is available
from their web site. This should be entertaining.


This entire security system is based on one dll. Here is the entire API.

CbN_BoxReady(unsigned int port number,unsigned char *boxname)

CbN_DecRAM1(unsigned int port number,unsigned int id number,unsigned char
*codeid,unsigned char *passwordram1, unsigned int counter address, unsigned
int new count)

CbN_DecRAM2(same as DecRAM1)

CbN_Decrypt(unsigned int port number, unsigned int id number,unsigned char
*codeid, unsigned int seed, unsigned int length,unsigned char *outdata)

Cbn_Encrypt(same as Decrypt)

CbN_IDEA_Decrypt(unsigned int port number, unsigned int id number, unsigned
char *codeid, unsigned char *buffer, unsigned long length)

CbN_IDEA_Encrypt(same as IDEA Decrypt)

CbN_IncRam1(unsigned int port number, unsigned int id number, unsigned char
*codeid,unsigned char *passwordram1, unsigned int counter address, unsigned
int *net count)

CbN_IncRam2(same as IncRam1)

CbN_ReadID1(unsigned int port number, unsigned char *code id,unsigned long
*idreturn)

CbN_ReadID2(same as readid1)
CbN_ReadID3(same as readid1)
CbN_ReadID4(same as readid1)
CbN_ReadID5(same as readid1)
CbN_ReadID6(same as readid1)
CbN_ReadID7(same as readid1)
CbN_ReadID8(same as readid1)
CbN_ReadRAM1(I'm getting tired of typing!)
CbN_ReadRAM2(...)
CbN_ReadSER(...)
CbN_WriteRAM1(...)
CbN_WriteRAM2(...)

And the various return codes

0 the function worked correctly
1 wrong or missing argument
2 crypto-box key not available
3 error on standard encryption
4 error on IDEA encryption
5 crypto-box memory read access error
6 crypto-box memory write access error
7 error on counter increment or decrement
8 error on function call CbN_BoxReady()

Part of the supposed security is the increase in number of bytes for
successive functions.

The serial number is 2 bytes long
The id number is 3 bytes long
The passwords are 4 bytes long

This is similar in many ways to the <font color=blue>software sentinel device</fonT> which they
have obviously copied from.


Here is an example of it's use in a program. This program is NOT available
from the net, and is of absolutely no use to 99% of the people out there.
It is a conversion from its original UNIX version, and as such has a few
bugs, but is still a highly valuable tool. As I have absolutely nothing
against this fine company, and some of this company's instruments are the
finest available in the world, I will not divulge the name of the program.


* Reference To: CBNDLL.CbN_ReadSER, Ord:0020h
                                  |
:0043431C E8F3791700              Call 005ABD14
:00434321 0FBFC0                  movsx eax, ax
:00434324 8985ACFEFFFF            mov dword ptr [ebp+FFFFFEAC], eax
:0043432A 83BDACFEFFFF00          cmp dword ptr [ebp+FFFFFEAC], 00000000
:00434331 0F8E11000000            jle 00434348
:00434337 6A00                    push 00000000
:00434339 8B85ACFEFFFF            mov eax, dword ptr [ebp+FFFFFEAC]
:0043433F 50                      push eax
:00434340 E8B2DFFCFF              call 004022F7
:00434345 83C408                  add esp, 00000008

* Referenced by a Jump at Address:00434331(C)
|
:00434348 817DE4XXXXXXXX          cmp dword ptr [ebp-1C],XXXXXXXX
:0043434F 0F840F000000            je 00434364

* StringData Ref from Data Obj ->"The ..."  removed for obvious reasons
                                                                          
:00434355 68D8EF6100              push 0061EFD8
:0043435A 6A63                    push 00000063
:0043435C E896DFFCFF              call 004022F7
:00434361 83C408                  add esp, 00000008

* Referenced by a Jump at Address:0043434F(C)
|
:00434364 C685A8FEFFFFXX          mov byte ptr [ebp+FFFFFEA8], XX
:0043436B C685A9FEFFFFXX          mov byte ptr [ebp+FFFFFEA9], XX
:00434372 C685AAFEFFFFXX          mov byte ptr [ebp+FFFFFEAA], XX
:00434379 C685ABFEFFFFXX          mov byte ptr [ebp+FFFFFEAB], XX
:00434380 C685BCFEFFFFXX          mov byte ptr [ebp+FFFFFEBC], XX
:00434387 C685BDFEFFFFXX          mov byte ptr [ebp+FFFFFEBD], XX
:0043438E C685BEFEFFFFXX          mov byte ptr [ebp+FFFFFEBE], XX
:00434395 C685BFFEFFFFXX          mov byte ptr [ebp+FFFFFEBF], XX
:0043439C C685C0FEFFFFXX          mov byte ptr [ebp+FFFFFEC0], XX
:004343A3 8D45EC                  lea eax, dword ptr [ebp-14]
:004343A6 50                      push eax
:004343A7 8B85B0FEFFFF            mov eax, dword ptr [ebp+FFFFFEB0]
:004343AD 50                      push eax
:004343AE 6A14                    push 00000014
:004343B0 8D85BCFEFFFF            lea eax, dword ptr [ebp+FFFFFEBC]
:004343B6 50                      push eax
:004343B7 8D85A8FEFFFF            lea eax, dword ptr [ebp+FFFFFEA8]
:004343BD 50                      push eax
:004343BE 6A01                    push 00000001
:004343C0 6A01                    push 00000001

* Reference To: CBNDLL.CbN_ReadRAM1, Ord:001Eh
                                  |
:004343C2 E847791700              Call 005ABD0E
:004343C7 0FBFC0                  movsx eax, ax
:004343CA 8985ACFEFFFF            mov dword ptr [ebp+FFFFFEAC], eax
:004343D0 83BDACFEFFFF00          cmp dword ptr [ebp+FFFFFEAC], 00000000
:004343D7 0F8E0F000000            jle 004343EC

* StringData Ref from Data Obj ->"R..." Removed for obvious reasons
                                  |
:004343DD 6808F06100              push 0061F008
:004343E2 6A63                    push 00000063
:004343E4 E80EDFFCFF              call 004022F7
:004343E9 83C408                  add esp, 00000008

* Referenced by a Jump at Address:004343D7(C)
|
:004343EC 8B85B0FEFFFF            mov eax, dword ptr [ebp+FFFFFEB0]
:004343F2 C64405EC00              mov [ebp+eax-14], 00
:004343F7 8D45C8                  lea eax, dword ptr [ebp-38]
:004343FA 50                      push eax
:004343FB 8D45EC                  lea eax, dword ptr [ebp-14]
:004343FE 50                      push eax
:004343FF E8DC8A1700              call 005ACEE0
:00434404 83C408                  add esp, 00000008
:00434407 85C0                    test eax, eax
:00434409 0F840F000000            je 0043441E

* StringData Ref from Data Obj ->"C..." Same here
                                  |
:0043440F 6810F06100              push 0061F010
:00434414 6A63                    push 00000063
:00434416 E8DCDEFCFF              call 004022F7
:0043441B 83C408                  add esp, 00000008

* Referenced by a Jump at Address:00434409(C)
|
:0043441E 33C0                    xor eax, eax
:00434420 E900000000              jmp 00434425

* Referenced by a Jump at Addresses:004342E3(U), :00434420(U)
|
:00434425 5F                      pop edi
:00434426 5E                      pop esi
:00434427 5B                      pop ebx
:00434428 C9                      leave
:00434429 C3                      ret


it's a "no brainer" to replace the beginning of the code with a

		xor   eax,eax
		pop	edi
		pop	esi
		pop	ebx
		leave
		ret


As I am a programmer (among other things) I have the attitude that software
Protection is a waste of time. I believe that some other programmer's have 
the same opinion, they are forced by their bosses to install crap such as 
this, and they personally do not care that it can be reversed in minutes.</prE>
<br><br>

<!-- OB DUH STARTS HERE -->
<TABLE CELLPADDING="1" CELLSPACING="2" BORDER="1" HEIGHT="45"  WIDTH= "100%">
<tr><td bgcolor="#C6E7C6"><center><font size=+2><font color=blue>Ob Duh</fonT></fonT>
</center></td></tr></table>
 <center>
   <i>I wont even bother explaining you 
   that you should BUY this target program if you ever find it on the 
   web and intend to use it for a longer 
   period than the allowed one. Should you want 
   to STEAL this software instead, you don't need to crack its protection 
   scheme at all: you'll 
   find it on most Warez sites, complete and already regged, farewell.</i>
</center>

<!-- WAY OUT STARTS HERE -->
<hr>
<center><i>You are deep inside fravia's page of reverse engineering,  
choose your way out:</i></center>
<br><center>
<!-- EITHER A NICE GIF LIKE THIS -->


<a href="project3.htm" tppabs="http://ftp.fravia.org/project3.htm"><IMG SRC="project3.gif" tppabs="http://ftp.fravia.org/project3.gif" 
ALT="projecT3" ALIGN=CENTER WIDTH=114 HEIGHT=43 BORDER=0 VSPACE=0 HSPACE=0></a>
<br>
<font color=gray>Back to project 3</FonT>
<br><bR>

<!-- OR JUST A LINK LIKE THIS -->

<!--
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="project1.htm" tppabs="http://ftp.fravia.org/project1.htm">Back to Your_chosen_project</A> 
<hr width=33%>
-->

<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="index.html" tppabs="http://ftp.fravia.org/index.html">homepage</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="links.htm" tppabs="http://ftp.fravia.org/links.htm">links</A> 
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="searengi.htm" tppabs="http://ftp.fravia.org/searengi.htm">search_forms</A>

<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="orc.htm" tppabs="http://ftp.fravia.org/orc.htm">+ORC</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="student.htm" tppabs="http://ftp.fravia.org/student.htm">students' essays</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="academy.htm" tppabs="http://ftp.fravia.org/academy.htm">academy database</A>
<br>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="realicra.htm" tppabs="http://ftp.fravia.org/realicra.htm">reality cracking</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="howtosea.htm" tppabs="http://ftp.fravia.org/howtosea.htm">how to search</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="javascri.htm" tppabs="http://ftp.fravia.org/javascri.htm">javascript wars</A>
<br>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tools.htm" tppabs="http://ftp.fravia.org/tools.htm">tools</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="noanon.htm" tppabs="http://ftp.fravia.org/noanon.htm">anonymity academy</A> 
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="cocktail.htm" tppabs="http://ftp.fravia.org/cocktail.htm">cocktails</A>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="tppmsgs/msgs1.htm#137" tppabs="http://fravia.org/ideale.htm">antismut CGI-scripts</A>

<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="info.htm" tppabs="http://ftp.fravia.org/info.htm">mail_fravia+</A>
<br>
<IMG SRC="bulletr.gif" tppabs="http://ftp.fravia.org/bulletr.gif" ALT="red" ALIGN=BOTTOM WIDTH=13 HEIGHT=13 
BORDER=0 VSPACE=0 HSPACE=0><A HREF="legal.htm" tppabs="http://ftp.fravia.org/legal.htm">Is reverse engineering legal?</A>
</CENTER>
<hr>
<!-- THAT'S ALL, THANKS A LOT this will allow automated retrieval -->
</BODY>
</HTML>